{"files":[{"id":"9626fdaa-0776-44c2-9aef-2c56dec7f3c6","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Argentina/Buenos_Aires\",\n  \"dependencies\": {\n    \"libraries\": [\n      {\n        \"userSymbol\": \"Clases\",\n        \"version\": \"0\",\n        \"libraryId\": \"1rlFgxE64QY6hhI7EwbQdYF8Fc3z8reTqd07KxqSoyjQU0pSCW3XAoaWz\",\n        \"developmentMode\": true\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"bf38e794-790d-4d72-b775-8de462846a1f","name":"Código","type":"server_js","source":"function dameClientes(){\n\n  var colClientes \u003d [];\n\n  const contactos \u003d ContactsApp.getAllContacts()\n\n  contactos.forEach((x)\u003d\u003e{\n    if(x.getFullName() !\u003d \"\"){\n      //console.log(x.getFullName())\n      var miCliente \u003d new Clases.getCliente(x.getFullName(),x.getMobilePhone(),x.getEmailAddresses()[0])\n      colClientes.push(miCliente)\n    }\n  });\n\n /*  \n  var cliente1 \u003d Clases.getCliente(\"Cliente uno\",[\"123456\"],\"clienteuno@zabella.com\");\n  var cliente2 \u003d Clases.getCliente(\"Cliente dos\",[\"654321\"],\"clientedos@zabella.com\");\n  var cliente3 \u003d Clases.getCliente(\"Cliente tres\",[\"666666\"],\"clientetres@zabella.com\");\n\n  colClientes.push(cliente1);\n  colClientes.push(cliente2);\n  colClientes.push(cliente3);\n\n  implementación\n  -----------------\n  -----------------\n  ¿Algún id de Contactos?\n*/\n\n  return colClientes;\n}\n\nfunction testDameClientes(){\n  Logger.log(dameClientes());\n}\n\n\n\nfunction eliminarObjeto(id_obj,id_col){\n  /*\n  Elimina un objeto de una colección\n  @param {string} id del Objeto para eliminar de la colección\n  @param {string} id de la colección desde donde se eliminará el objeto\n  */\n\n  var libroColeccion \u003d SpreadsheetApp.openById(id_col)\n  var hojaColeccion \u003d libroColeccion.getSheetByName(\"Hoja 1\")\n  var str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n\n  try{\n    if(str_coleccion \u003d\u003d \"\"){\n      var tmp \u003d []\n      var str_tmp \u003d JSON.stringify(tmp)\n      hojaColeccion.getRange(1,1).setValue(str_tmp)\n    }\n    str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n    var obj_coleccion \u003d JSON.parse(str_coleccion)\n    \n    var nueva_obj_coleccion \u003d []\n    obj_coleccion.forEach(function(x){\n      if(x.id !\u003d id_obj){\n        nueva_obj_coleccion.push(x)\n      }\n    })\n    \n    str_coleccion \u003d JSON.stringify(nueva_obj_coleccion)\n    hojaColeccion.getRange(1,1).setValue(str_coleccion)\n\n  }catch(e){\n    return new Error(\"Operación fallida\")\n  }\n}\n\nfunction dameObjeto(id_obj,id_col){\n  /*\n  Devuelve un objeto de una colección\n  @param {string} id del Objeto para devolver de la colección\n  @param {string} id de la colección desde donde se devolverá el objeto\n  */\n\n  var libroColeccion \u003d SpreadsheetApp.openById(id_col)\n  var hojaColeccion \u003d libroColeccion.getSheetByName(\"Hoja 1\")\n  var str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n\n  try{\n    if(str_coleccion \u003d\u003d \"\"){\n      var tmp \u003d []\n      var str_tmp \u003d JSON.stringify(tmp)\n      hojaColeccion.getRange(1,1).setValue(str_tmp)\n    }\n    str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n    var obj_coleccion \u003d JSON.parse(str_coleccion)\n    \n    var objParDev\u003d {}\n    obj_coleccion.forEach(function(x){\n      if(x.id \u003d\u003d id_obj){\n        objParDev \u003d x\n      }\n    })\n    \n    return objParDev\n\n  }catch(e){\n    return new Error(\"Operación fallida\")\n  }\n}\n\n\n//-------------------------------------------------------------\n\n\n\nfunction dameColeccion(id_col){\n\n  /**\n   * Devuelve la colección completa de objetos\n   * \n   * @param {string} id de la colección que será devuelta\n   *  */  \n  \n  try{ \n  var libroColeccion \u003d SpreadsheetApp.openById(id_col)\n  var hojaColeccion \u003d libroColeccion.getSheetByName(\"Hoja 1\")\n  var str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n\n  \n      if(str_coleccion \u003d\u003d \"\"){\n        var tmp \u003d []\n        var str_tmp \u003d JSON.stringify(tmp)\n        hojaColeccion.getRange(1,1).setValue(str_tmp)\n      }\n      str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n      var obj_coleccion \u003d JSON.parse(str_coleccion)\n\n      return obj_coleccion\n\n  }catch(e){\n    return e\n  }\n}\n\n\n\n\nfunction agregarObjeto(obj,id_col){\n\n  /**\n   * Agrega un objeto a una colección\n   * \n   * @param {object} Objeto para agregar a la colección\n   * @param {string} id de la colección donde se agregará el objeto\n   *  */  \n\n  var libroColeccion \u003d SpreadsheetApp.openById(id_col)\n  var hojaColeccion \u003d libroColeccion.getSheetByName(\"Hoja 1\")\n  var str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n\n  try{\n    if(str_coleccion \u003d\u003d \"\"){\n      var tmp \u003d []\n      var str_tmp \u003d JSON.stringify(tmp)\n      hojaColeccion.getRange(1,1).setValue(str_tmp)\n    }\n    str_coleccion \u003d hojaColeccion.getRange(1,1).getValue()\n    var obj_coleccion \u003d JSON.parse(str_coleccion)\n    \n    var bandera \u003d false;\n    var indice;\n    for(var i\u003d0 ;i\u003c obj_coleccion.length ; i++){\n      if(obj_coleccion[i].nombre \u003d\u003d obj.nombre){\n        bandera \u003d true; \n        indice \u003d i;\n      }\n    }\n\n    if(bandera \u003d\u003d true){\n      obj_coleccion[indice] \u003d obj;\n    }else{\n      obj_coleccion.push(obj);\n    }\n\n    str_coleccion \u003d JSON.stringify(obj_coleccion)\n    hojaColeccion.getRange(1,1).setValue(str_coleccion)\n\n  }catch(e){\n    return new Error(\"Operación fallida\")\n  }\n}\n\nfunction modificarObjeto(id_obj,id_col,nuevoObj){\n  /* Obtengo el objeto a modificar desde la colección */\n  var miObjetoViejo \u003d dameObjeto(id_obj,id_col)\n  var atributos \u003d Object.keys(miObjetoViejo)\n\n  /* Actualizo todos los atributos exepto el id */\n  for(var i\u003d0 ; i\u003catributos.length ; i++){\n    if(atributos[i]!\u003d\"id\"){\n      miObjetoViejo[atributos[i]] \u003d nuevoObj[atributos[i]]\n    }\n  }\n\n  /* Eliminamos objeto extraído y agrego el nuevo\n  que tiene el mismo id */\n  eliminarObjeto(id_obj,id_col)\n  agregarObjeto(miObjetoViejo,id_col)\n}\n\nfunction testModificarObjeto(){\n  var id_ObjMod \u003d \"40bd7e4d-8dc9-4d83-b66e-a35970e88870\"\n  var id_Col \u003d \u00271ptYqzXI7qIsV-039e-uCGUFu46_Qlh_ExIKl40JpluY\u0027\n  var miObjeto \u003d Clases.getTecnica(\"María Esther\",\"999888\");\n  modificarObjeto(id_ObjMod,id_Col,miObjeto)\n}\n\nfunction dameObjetoNuevo(){\n  Logger.log(toString(Clases))\n\n  Logger.log(JSON.parse(Clases))\n  Logger.log(JSON.parse(toString(Clases)))  \n}\n\n\n\n\n\n\n\n\n\n\n"}]}